(function(){"use strict";var t={82841:function(t,e,i){var n=i(49963),a=i(66252);function s(t,e){const i=(0,a.up)("router-view");return(0,a.wg)(),(0,a.j4)(i)}const r={};r.render=s;var h=r,o=i(42119),c=i(3577);const d=(0,a.HX)("data-v-0056dd39"),l=d(((t,e,i,n,s,r)=>{const h=(0,a.up)("Item");return(0,a.wg)(),(0,a.j4)("div",null,[(0,a.Wm)("div",null,"锚点索引："+(0,c.zw)(s.anchorItem.index),1),(0,a.Wm)("div",null,"锚点偏移："+(0,c.zw)(s.anchorItem.offset),1),(0,a.Wm)("div",null,"平移量："+(0,c.zw)(s.translateY),1),(0,a.Wm)("div",null,"滚动高度："+(0,c.zw)(r.actualHeight),1),(0,a.Wm)("div",{class:"infinite-scroll",ref:"container",onScroll:e[1]||(e[1]=(...t)=>r.handleScroll&&r.handleScroll(...t))},[(0,a.Wm)("div",{class:"infinite-scroll_runway",style:{height:`${r.actualHeight}px`}},null,4),(0,a.Wm)("ul",{style:{transform:`translateY(${s.translateY}px)`}},[((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(s.visibleList,(t=>((0,a.wg)(),(0,a.j4)(h,{class:"item-card","data-index":t.index,ref:r.setItemRefs,key:t.index,data:t,onSizeChange:r.handleSizeChange},null,8,["data-index","data","onSizeChange"])))),128))],4)],544)])})),u=(0,a.HX)("data-v-51eaa20d");(0,a.dD)("data-v-51eaa20d");const f={class:"person-info-card_inner"},m={class:"person-info-card_base-info"},p={class:"item"},g={class:"item"},v={class:"item"},x={class:"item"},b={class:"person-info-card_paragraph"};(0,a.Cn)();const w=u(((t,e,i,n,s,r)=>((0,a.wg)(),(0,a.j4)("li",{class:"person-info-card",ref:"card","data-index":i.data.index},[(0,a.Wm)("div",f,[(0,a.Wm)("div",m,[(0,a.Wm)("span",p,(0,c.zw)(i.data.index),1),(0,a.Wm)("span",g,(0,c.zw)(i.data.name),1),(0,a.Wm)("span",v,(0,c.zw)(i.data.email),1),(0,a.Wm)("span",x,(0,c.zw)(i.data.phone),1),(0,a.Wm)("div",b,(0,c.zw)(i.data.paragraph),1)])])],8,["data-index"]))));var I={name:"Item",props:{data:Object,default(){return{}},fixedHeight:{type:Boolean,default:!1},sizeChange:{type:Function,default:()=>{}}},mounted(){if(this.fixedHeight)return;const t=new ResizeObserver((t=>{const[{contentRect:{height:e}}]=t;0!==e&&this.$emit("sizeChange",this.data.index,e+12)}));t.observe(this.$refs.card),(0,a.Ah)((()=>{t.disconnect.bind(t)}))}};I.render=w,I.__scopeId="data-v-51eaa20d";var H=I,_=i(2262),z=i(85384),y=i.n(z);function O(t=100){return new Promise((e=>{const i=[];for(let n=0;n<t;n++){const t=y().helpers.contextualCard();t.paragraph=y().lorem.paragraph(),i.push(t)}e(i)}))}var S={name:"Home",components:{Item:H},data(){return{bufferSize:8,estimated_height:180,startAttachedIndex:0,endAttachedIndex:0,anchorItem:{index:0,offset:0},visibleCount:0,visibleList:[],cachedHeight:[],translateY:0,prevScrollTop:0,itemRefs:[]}},computed:{actualHeight(){let t=0;return this.userList.forEach(((e,i)=>{t+=this.cachedHeight[i]||this.estimated_height})),t}},setup(){const t=(0,_.iH)([]),e=async e=>{t.value=await O(e),t.value.forEach(((t,e)=>{Object.assign(t,{index:e})}))};return{userList:t,getUserList:e}},async mounted(){const{clientHeight:t}=this.$refs.container;this.visibleCount=Math.floor(t/this.estimated_height),await this.getUserList(1e3),this.getVisibleData()},methods:{setItemRefs(t){this.itemRefs.includes(t)||this.itemRefs.push(t)},getVisibleData(){this.startAttachedIndex=Math.max(0,this.anchorItem.index-this.bufferSize),this.endAttachedIndex=Math.min(this.anchorItem.index+this.visibleCount+this.bufferSize,this.userList.length),this.visibleList=this.userList.slice(this.startAttachedIndex,this.endAttachedIndex)},updateAnchorItem(t){let{index:e}=this.anchorItem;t+=this.anchorItem.offset;const{scrollTop:i}=this.$refs.container;if(i<=0&&(this.translateY=0),t>0){if(this.endAttachedIndex>=this.userList.length)return;while(e<this.userList.length&&t>(this.cachedHeight[e]||this.estimated_height))this.cachedHeight[e]||(this.cachedHeight[e]=this.estimated_height),t-=this.cachedHeight[e],e++;this.anchorItem={index:e,offset:t}}else{while(t<0)this.cachedHeight[e-1]||(this.cachedHeight[e-1]=this.estimated_height),t+=this.cachedHeight[e-1],e--;this.anchorItem=e<0?{index:0,offset:0}:{index:e,offset:t}}},handleScroll(){const t=this.$refs.container.scrollTop-this.prevScrollTop;this.prevScrollTop=this.$refs.container.scrollTop,this.updateAnchorItem(t),this.getVisibleData()},handleSizeChange(t,e){this.cachedHeight[t]=e,this.calTranslateY()},async calTranslateY(){await this.$nextTick();const{scrollTop:t}=this.$refs.container,{index:e,offset:i}=this.anchorItem,n=t-i;let a=n;for(let s=e-1;s>=this.startAttachedIndex;s--)a-=this.cachedHeight[s];this.translateY=a}}};S.render=l,S.__scopeId="data-v-0056dd39";var W=S;const j=[{path:"/list",name:"List",component:W},{path:"/:pathMatch(.*)*",redirect:{name:"List"}}],C=(0,o.p7)({history:(0,o.PO)(),routes:j});var L=C;(0,n.ri)(h).use(L).mount("#app")}},e={};function i(n){var a=e[n];if(void 0!==a)return a.exports;var s=e[n]={exports:{}};return t[n](s,s.exports,i),s.exports}i.m=t,function(){var t=[];i.O=function(e,n,a,s){if(!n){var r=1/0;for(c=0;c<t.length;c++){n=t[c][0],a=t[c][1],s=t[c][2];for(var h=!0,o=0;o<n.length;o++)(!1&s||r>=s)&&Object.keys(i.O).every((function(t){return i.O[t](n[o])}))?n.splice(o--,1):(h=!1,s<r&&(r=s));h&&(t.splice(c--,1),e=a())}return e}s=s||0;for(var c=t.length;c>0&&t[c-1][2]>s;c--)t[c]=t[c-1];t[c]=[n,a,s]}}(),function(){i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,{a:e}),e}}(),function(){i.d=function(t,e){for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};i.O.j=function(e){return 0===t[e]};var e=function(e,n){var a,s,r=n[0],h=n[1],o=n[2],c=0;for(a in h)i.o(h,a)&&(i.m[a]=h[a]);if(o)var d=o(i);for(e&&e(n);c<r.length;c++)s=r[c],i.o(t,s)&&t[s]&&t[s][0](),t[r[c]]=0;return i.O(d)},n=self["webpackChunkinfinite_scroll_demo"]=self["webpackChunkinfinite_scroll_demo"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=i.O(void 0,[998],(function(){return i(82841)}));n=i.O(n)})();
//# sourceMappingURL=app.8f48ae7d.js.map